{"version":3,"file":"fieldslistfield.bundle.js","sources":["../src/fieldslistfield.js"],"sourcesContent":["import {BaseField} from 'landing.ui.field.basefield';\nimport {Loc} from 'landing.loc';\nimport {Dom, Runtime, Tag, Text, Type} from 'main.core';\nimport {Draggable} from 'ui.draganddrop.draggable';\nimport {FieldsPanel} from 'landing.ui.panel.fieldspanel';\nimport {ListItem} from 'landing.ui.component.listitem';\nimport {ActionPanel} from 'landing.ui.component.actionpanel';\nimport {TextField} from 'landing.ui.field.textfield';\nimport {BaseEvent} from 'main.core.events';\nimport {FormSettingsForm} from 'landing.ui.form.formsettingsform';\nimport {FormClient} from 'crm.form.client';\nimport {ListSettingsField} from 'landing.ui.field.listsettingsfield';\nimport {SeparatorPanel} from 'landing.ui.panel.separatorpanel';\nimport {PageObject} from 'landing.pageobject';\nimport {Loader} from 'main.loader';\nimport type {ListItemOptions} from 'landing.ui.component.listitem';\nimport {ProductField} from 'landing.ui.field.productfield';\nimport 'calendar.resourcebookinguserfield';\nimport 'socnetlogdest';\n\nimport './css/style.css';\n\nexport class FieldsListField extends BaseField\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.UI.Field.FieldsListField');\n\t\tthis.setLayoutClass('landing-ui-field-fields-list');\n\n\t\tthis.onSelectFieldButtonClick = this.onSelectFieldButtonClick.bind(this);\n\t\tthis.onSelectProductsButtonClick = this.onSelectProductsButtonClick.bind(this);\n\t\tthis.onSelectSeparatorButtonClick = this.onSelectSeparatorButtonClick.bind(this);\n\t\tthis.onItemRemove = this.onItemRemove.bind(this);\n\t\tthis.onItemEdit = this.onItemEdit.bind(this);\n\t\tthis.onDragEnd = this.onDragEnd.bind(this);\n\t\tthis.onFormChange = this.onFormChange.bind(this);\n\n\t\tthis.items = [];\n\n\t\tthis.options.items.forEach((itemOptions) => {\n\t\t\tthis.addItem(itemOptions);\n\t\t});\n\n\t\tthis.actionPanel = new ActionPanel({\n\t\t\trenderTo: this.layout,\n\t\t\tleft: [\n\t\t\t\t{\n\t\t\t\t\tid: 'selectField',\n\t\t\t\t\ttext: Loc.getMessage('LANDING_FIELDS_SELECT_FIELD_BUTTON_TITLE'),\n\t\t\t\t\tonClick: this.onSelectFieldButtonClick,\n\t\t\t\t},\n\t\t\t],\n\t\t\tright: [\n\t\t\t\t{\n\t\t\t\t\tid: 'addProducts',\n\t\t\t\t\ttext: Loc.getMessage('LANDING_FIELDS_SELECT_PRODUCTS_BUTTON_TITLE'),\n\t\t\t\t\tonClick: this.onSelectProductsButtonClick,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'selectSeparator',\n\t\t\t\t\ttext: Loc.getMessage('LANDING_FIELDS_SELECT_SEPARATOR_BUTTON_TITLE'),\n\t\t\t\t\tonClick: this.onSelectSeparatorButtonClick,\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\n\t\tthis.draggable = new Draggable({\n\t\t\tcontext: window.parent,\n\t\t\tcontainer: this.getListContainer(),\n\t\t\tdraggable: '.landing-ui-component-list-item',\n\t\t\tdragElement: '.landing-ui-button-icon-drag',\n\t\t\ttype: Draggable.MOVE,\n\t\t\toffset: {\n\t\t\t\ty: -62,\n\t\t\t},\n\t\t});\n\n\t\tthis.draggable.subscribe('end', this.onDragEnd);\n\t}\n\n\tcreateInput(): HTMLDivElement\n\t{\n\t\treturn this.getListContainer();\n\t}\n\n\tgetCrmFieldById(id: string)\n\t{\n\t\treturn Object.values(this.options.crmFields)\n\t\t\t.reduce((acc, category) => {\n\t\t\t\treturn [...acc, ...category.FIELDS];\n\t\t\t}, [])\n\t\t\t.find((currentField) => {\n\t\t\t\treturn currentField.name === id;\n\t\t\t});\n\t}\n\n\tgetCrmFieldCategoryById(id: string)\n\t{\n\t\treturn this.options.crmFields[id];\n\t}\n\n\taddItem(itemOptions)\n\t{\n\t\treturn this.createItem(itemOptions)\n\t\t\t.then((item) => {\n\t\t\t\tthis.items.push(item);\n\t\t\t\tDom.append(item.getLayout(), this.getListContainer());\n\t\t\t});\n\t}\n\n\tprependItem(itemOptions)\n\t{\n\t\treturn this.createItem(itemOptions)\n\t\t\t.then((item) => {\n\t\t\t\tthis.items.unshift(item);\n\t\t\t\tDom.prepend(item.getLayout(), this.getListContainer());\n\t\t\t});\n\t}\n\n\tinsertItemAfterIndex(itemOptions, index)\n\t{\n\t\treturn this.createItem(itemOptions)\n\t\t\t.then((item) => {\n\t\t\t\tthis.items.splice((index + 1), 0, item);\n\t\t\t\tDom.insertAfter(item.getLayout(), this.getListContainer().childNodes[index]);\n\t\t\t});\n\t}\n\n\tstatic isSeparator(fieldId: ?string): boolean\n\t{\n\t\tif (Type.isStringFilled(fieldId))\n\t\t{\n\t\t\treturn (\n\t\t\t\tfieldId.startsWith('hr')\n\t\t\t\t|| fieldId.startsWith('section')\n\t\t\t\t|| fieldId.startsWith('page')\n\t\t\t);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tstatic getSeparatorTitle(fieldId: ?string): string\n\t{\n\t\tif (Type.isStringFilled(fieldId))\n\t\t{\n\t\t\tif (fieldId.startsWith('hr'))\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('LANDING_SEPARATOR_SOLID_LINE');\n\t\t\t}\n\n\t\t\tif (fieldId.startsWith('section'))\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('LANDING_SEPARATOR_HEADER');\n\t\t\t}\n\n\t\t\tif (fieldId.startsWith('page'))\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('LANDING_SEPARATOR_PAGE');\n\t\t\t}\n\t\t}\n\n\t\treturn Loc.getMessage('LANDING_FIELDS_LIST_FIELD_SEPARATOR_TITLE');\n\t}\n\n\tisFieldAvailable(fieldId: ?string): boolean\n\t{\n\t\tif (Type.isStringFilled(fieldId))\n\t\t{\n\t\t\tif (fieldId.startsWith('product_'))\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn Type.isPlainObject(\n\t\t\t\tthis.getCrmFieldById(fieldId),\n\t\t\t);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetFieldItemTitle(fieldId: ?string): string\n\t{\n\t\tif (this.isFieldAvailable(fieldId))\n\t\t{\n\t\t\tif (fieldId.startsWith('product_'))\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('LANDING_FIELDS_LIST_FIELD_PRODUCTS_TITLE');\n\t\t\t}\n\n\t\t\tconst crmField = this.getCrmFieldById(fieldId);\n\t\t\tconst crmFieldCategory = this.getCrmFieldCategoryById(crmField.entity_name);\n\n\t\t\treturn `${crmField.caption} Â· ${crmFieldCategory.CAPTION}`;\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tcreateResourceBookingFieldController(options: {[key: string]: any})\n\t{\n\t\tif (options.type === 'resourcebooking')\n\t\t{\n\t\t\tconst root = PageObject.getRootWindow();\n\t\t\tconst crmField = this.getCrmFieldById(options.id);\n\t\t\treturn root.BX.Calendar.ResourcebookingUserfield.initCrmFormFieldController({\n\t\t\t\tfield: {\n\t\t\t\t\t...options,\n\t\t\t\t\tdict: crmField,\n\t\t\t\t\tnode: Tag.render`<div><div class=\"crm-webform-resourcebooking-wrap\"></div></div>`,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tcreateItem(\n\t\toptions: {\n\t\t\tid: string,\n\t\t\tlabel: string,\n\t\t\tdescription: string,\n\t\t\tcontent?: any,\n\t\t\ttype?: any,\n\t\t\tseparatorTitle?: any,\n\t\t},\n\t): Promise<ListItem>\n\t{\n\t\tconst listItemOptions: ListItemOptions = {\n\t\t\tid: options.id,\n\t\t\ttype: options.type ? options.type : '',\n\t\t\tcontent: options.content,\n\t\t\tsourceOptions: {...options},\n\t\t\tdraggable: true,\n\t\t\tremovable: true,\n\t\t\tonRemove: this.onItemRemove,\n\t\t\tonEdit: this.onItemEdit,\n\t\t\tonFormChange: this.onFormChange,\n\t\t\tform: this.createFieldSettingsForm(options),\n\t\t};\n\n\t\tif (!FieldsListField.isSeparator(options.id))\n\t\t{\n\t\t\tif (this.isFieldAvailable(options.id))\n\t\t\t{\n\t\t\t\tlistItemOptions.title = this.getFieldItemTitle(options.id);\n\n\t\t\t\tconst crmField = this.getCrmFieldById(options.id);\n\t\t\t\tlistItemOptions.description = options.label || crmField.caption;\n\t\t\t\tlistItemOptions.editable = true;\n\t\t\t\tlistItemOptions.isSeparator = false;\n\t\t\t\tlistItemOptions.fieldController = this.createResourceBookingFieldController(options);\n\n\t\t\t\tconst listItem = new ListItem(listItemOptions);\n\n\t\t\t\tif (listItemOptions.fieldController)\n\t\t\t\t{\n\t\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\t\tif (Type.isFunction(listItemOptions.fieldController.subscribe))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlistItemOptions.fieldController.subscribe('afterInit', (event) => {\n\t\t\t\t\t\t\t\toptions.booking.settings_data = event.getData().settings.data;\n\t\t\t\t\t\t\t\tresolve(listItem);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresolve(listItem);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn Promise.resolve(listItem);\n\t\t\t}\n\n\t\t\tlistItemOptions.editable = false;\n\t\t\tlistItemOptions.isSeparator = false;\n\t\t\tlistItemOptions.title = '';\n\t\t\tlistItemOptions.description = Loc.getMessage('LANDING_FIELDS_ITEM_FIELD_UNAVAILABLE');\n\t\t\tlistItemOptions.error = true;\n\n\t\t\tconst listItem = new ListItem(listItemOptions);\n\n\t\t\treturn Promise.resolve(listItem);\n\t\t}\n\n\t\tlistItemOptions.isSeparator = true;\n\t\tlistItemOptions.editable = !String(options.id).startsWith('hr_');\n\t\tlistItemOptions.title = FieldsListField.getSeparatorTitle(options.id);\n\n\t\tif (Type.isString(options.label))\n\t\t{\n\t\t\tlistItemOptions.description = options.label;\n\t\t}\n\t\telse if (String(options.id).startsWith('hr_'))\n\t\t{\n\t\t\tlistItemOptions.description = FieldsListField.getSeparatorTitle(options.id);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst crmField = this.getCrmFieldById(options.id);\n\t\t\tif (Type.isPlainObject(crmField) && Type.isString(crmField.caption))\n\t\t\t{\n\t\t\t\tlistItemOptions.description = crmField.caption;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlistItemOptions.description = '';\n\t\t\t}\n\t\t}\n\n\t\tconst listItem = new ListItem(listItemOptions);\n\n\t\treturn Promise.resolve(listItem);\n\t}\n\n\t// eslint-disable-next-line class-methods-use-this\n\tcreateFieldSettingsForm(field)\n\t{\n\t\tconst fields = [];\n\n\t\tif (field.type === 'product')\n\t\t{\n\t\t\tfields.push(\n\t\t\t\tnew ProductField({\n\t\t\t\t\ttitle: Loc.getMessage('LANDING_FIELDS_LIST_FIELD_PRODUCTS_TITLE2'),\n\t\t\t\t\tselector: 'products',\n\t\t\t\t\titems: field.editing.catalog || [],\n\t\t\t\t\tiblockId: this.options.dictionary.catalog.id,\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tif (field.editing.hasLabel)\n\t\t{\n\t\t\tfields.push(\n\t\t\t\tnew TextField({\n\t\t\t\t\tselector: 'label',\n\t\t\t\t\ttitle: Loc.getMessage('LANDING_FIELDS_ITEM_FORM_LABEL_FIELD_TITLE'),\n\t\t\t\t\tcontent: field.label,\n\t\t\t\t\ttextOnly: true,\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tif (field.editing.canBeRequired)\n\t\t{\n\t\t\tfields.push(\n\t\t\t\tnew BX.Landing.UI.Field.Checkbox({\n\t\t\t\t\tselector: 'required',\n\t\t\t\t\tcompact: true,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: Loc.getMessage('LANDING_FIELDS_ITEM_FORM_REQUIRED_FIELD_TITLE'),\n\t\t\t\t\t\t\tvalue: 'required',\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tvalue: field.required ? ['required'] : [],\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tif (field.editing.canBeMultiple)\n\t\t{\n\t\t\tfields.push(\n\t\t\t\tnew BX.Landing.UI.Field.Checkbox({\n\t\t\t\t\tselector: 'multiple',\n\t\t\t\t\tcompact: true,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: Loc.getMessage('LANDING_FIELDS_ITEM_FORM_MULTIPLE_FIELD_TITLE'),\n\t\t\t\t\t\t\tvalue: 'multiple',\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tvalue: field.multiple ? ['multiple'] : [],\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tif (field.editing.hasStringDefaultValue)\n\t\t{\n\t\t\tfields.push(\n\t\t\t\tnew TextField({\n\t\t\t\t\tselector: 'value',\n\t\t\t\t\ttitle: Loc.getMessage('LANDING_FIELDS_ITEM_FORM_DEFAULT_VALUE_FIELD_TITLE'),\n\t\t\t\t\tcontent: field.value,\n\t\t\t\t\ttextOnly: true,\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tif (field.type === 'product')\n\t\t{\n\t\t\tfields.push(\n\t\t\t\tnew BX.Landing.UI.Field.Checkbox({\n\t\t\t\t\tselector: 'bigPic',\n\t\t\t\t\tcompact: true,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: Loc.getMessage('LANDING_FIELDS_LIST_FIELD_PRODUCTS_SHOW_BIG_PICTURE'),\n\t\t\t\t\t\t\tvalue: 'bigPic',\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tvalue: field.bigPic ? ['bigPic'] : [],\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tif (\n\t\t\t(\n\t\t\t\tfield.type === 'list'\n\t\t\t\t|| field.type === 'radio'\n\t\t\t)\n\t\t\t&& field.editing.items.length > 0\n\t\t)\n\t\t{\n\t\t\tconst defaultValueField = new BX.Landing.UI.Field.Dropdown({\n\t\t\t\tselector: 'value',\n\t\t\t\ttitle: Loc.getMessage('LANDING_FIELDS_ITEM_FORM_LIST_DEFAULT_VALUE_TITLE'),\n\t\t\t\tcontent: field.value,\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue: Loc.getMessage('LANDING_FORM_DEFAULT_VALUE_NOT_SELECTED'),\n\t\t\t\t\t\tid: null,\n\t\t\t\t\t},\n\t\t\t\t\t...field.editing.items,\n\t\t\t\t].map((item) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tname: item.value,\n\t\t\t\t\t\tvalue: item.id,\n\t\t\t\t\t};\n\t\t\t\t}),\n\t\t\t});\n\n\t\t\tfields.push(\n\t\t\t\tnew ListSettingsField({\n\t\t\t\t\tselector: 'items',\n\t\t\t\t\ttitle: Loc.getMessage('LANDING_FIELDS_ITEM_FORM_LIST_SETTINGS_TITLE'),\n\t\t\t\t\titems: (() => {\n\t\t\t\t\t\treturn field.editing.items.map((item) => {\n\t\t\t\t\t\t\tconst selectedItem = field.items.find((currentItem) => {\n\t\t\t\t\t\t\t\treturn String(currentItem.value) === String(item.id);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tconst checked = !!selectedItem;\n\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tname: checked ? selectedItem.label : item.value,\n\t\t\t\t\t\t\t\tvalue: item.id,\n\t\t\t\t\t\t\t\tchecked,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t});\n\t\t\t\t\t})(),\n\t\t\t\t}),\n\t\t\t);\n\n\t\t\tfields.push(defaultValueField);\n\t\t}\n\n\t\tif (\n\t\t\tType.isPlainObject(field.editing)\n\t\t\t&& Type.isArrayFilled(field.editing.valueTypes)\n\t\t)\n\t\t{\n\t\t\tfields.push(\n\t\t\t\tnew BX.Landing.UI.Field.Dropdown({\n\t\t\t\t\tselector: 'valueType',\n\t\t\t\t\ttitle: Loc.getMessage('LANDING_FIELDS_ITEM_FORM_VALUE_TYPE'),\n\t\t\t\t\tcontent: field.editing.editable.valueType,\n\t\t\t\t\titems: field.editing.valueTypes.map((item) => {\n\t\t\t\t\t\treturn {name: item.name, value: item.id};\n\t\t\t\t\t}),\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\treturn new FormSettingsForm({\n\t\t\tfields,\n\t\t\tserializeModifier(value) {\n\t\t\t\tconst modifiedValue = {...value};\n\t\t\t\tif (Reflect.has(value, 'label'))\n\t\t\t\t{\n\t\t\t\t\tmodifiedValue.label = Text.decode(value.label);\n\t\t\t\t}\n\n\t\t\t\tif (Reflect.has(value, 'required'))\n\t\t\t\t{\n\t\t\t\t\tmodifiedValue.required = value.required.includes('required');\n\t\t\t\t}\n\n\t\t\t\tif (Reflect.has(value, 'multiple'))\n\t\t\t\t{\n\t\t\t\t\tmodifiedValue.multiple = value.multiple.includes('multiple');\n\t\t\t\t}\n\n\t\t\t\tif (Reflect.has(value, 'bigPic'))\n\t\t\t\t{\n\t\t\t\t\tmodifiedValue.bigPic = value.bigPic.includes('bigPic');\n\t\t\t\t}\n\n\t\t\t\tif (Reflect.has(value, 'value') && Type.isArrayFilled(value.items))\n\t\t\t\t{\n\t\t\t\t\tmodifiedValue.items = modifiedValue.items.map((item) => {\n\t\t\t\t\t\titem.selected = (value.value === item.value);\n\t\t\t\t\t\treturn item;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (Reflect.has(value, 'products'))\n\t\t\t\t{\n\t\t\t\t\tmodifiedValue.items = Runtime.clone(value.products);\n\t\t\t\t\tif (!Type.isPlainObject(modifiedValue.editing))\n\t\t\t\t\t{\n\t\t\t\t\t\tmodifiedValue.editing = {};\n\t\t\t\t\t}\n\n\t\t\t\t\tmodifiedValue.editing.catalog = Runtime.clone(value.products);\n\t\t\t\t}\n\n\t\t\t\tif (Reflect.has(value, 'valueType'))\n\t\t\t\t{\n\t\t\t\t\tif (!Type.isPlainObject(modifiedValue.editing))\n\t\t\t\t\t{\n\t\t\t\t\t\tmodifiedValue.editing = {};\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isPlainObject(modifiedValue.editing.editable))\n\t\t\t\t\t{\n\t\t\t\t\t\tmodifiedValue.editing.editable = {};\n\t\t\t\t\t}\n\n\t\t\t\t\tmodifiedValue.editing.editable.valueType = value.valueType;\n\t\t\t\t}\n\n\t\t\t\treturn modifiedValue;\n\t\t\t},\n\t\t});\n\t}\n\n\tgetListContainer(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('listContainer', () => {\n\t\t\treturn Tag.render`<div class=\"landing-ui-field-fields-list-container\"></div>`;\n\t\t});\n\t}\n\n\tonSelectFieldButtonClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\n\t\tFieldsPanel\n\t\t\t.getInstance({\n\t\t\t\tisLeadEnabled: this.options.isLeadEnabled,\n\t\t\t})\n\t\t\t.show({\n\t\t\t\tdisabledFields: this.items.map((item) => item.options.id),\n\t\t\t})\n\t\t\t.then((selectedFields) => {\n\t\t\t\tif (Type.isArrayFilled(selectedFields))\n\t\t\t\t{\n\t\t\t\t\tthis.onFieldsSelect(selectedFields);\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tonFieldsSelect(selectedFields: Array<string>)\n\t{\n\t\tconst preparingOptions = {\n\t\t\tfields: selectedFields.map((fieldId) => {\n\t\t\t\treturn {name: fieldId};\n\t\t\t}),\n\t\t};\n\n\t\tvoid this.showLoader();\n\n\t\tFormClient.getInstance()\n\t\t\t.prepareOptions(this.options.formOptions, preparingOptions)\n\t\t\t.then((result) => {\n\t\t\t\tvoid this.hideLoader();\n\t\t\t\treturn Promise.all(\n\t\t\t\t\tresult.data.fields.map((field) => {\n\t\t\t\t\t\treturn this.addItem(field);\n\t\t\t\t\t}),\n\t\t\t\t);\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.emit('onChange', {skipPrepare: true});\n\t\t\t});\n\t}\n\n\tgetValue()\n\t{\n\t\treturn this.items.map((item) => {\n\t\t\treturn item.getValue();\n\t\t});\n\t}\n\n\t// eslint-disable-next-line class-methods-use-this\n\tonSelectProductsButtonClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\n\t\tconst preparingOptions = {\n\t\t\tfields: [\n\t\t\t\t{type: 'product'},\n\t\t\t],\n\t\t};\n\n\t\tvoid this.showLoader();\n\n\t\tFormClient\n\t\t\t.getInstance()\n\t\t\t.prepareOptions(this.options.formOptions, preparingOptions)\n\t\t\t.then((result) => {\n\t\t\t\tvoid this.hideLoader();\n\n\t\t\t\tconst promises = result.data.fields.map((field) => {\n\t\t\t\t\treturn this.addItem(field);\n\t\t\t\t});\n\n\t\t\t\tPromise.all(promises)\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tthis.emit('onChange', {skipPrepare: true});\n\t\t\t\t\t});\n\t\t\t});\n\t}\n\n\tonSelectSeparatorButtonClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\t\tSeparatorPanel.getInstance()\n\t\t\t.show()\n\t\t\t.then((separator) => {\n\t\t\t\tconst fields = [separator];\n\n\t\t\t\tif (\n\t\t\t\t\tseparator.type === 'page'\n\t\t\t\t\t&& !this.items.find((item) => item.options.type === 'page')\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tfields.push({...fields[0]});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvoid this.showLoader();\n\n\t\t\t\tFormClient.getInstance()\n\t\t\t\t\t.prepareOptions(this.options.formOptions, {fields})\n\t\t\t\t\t.then((result) => {\n\t\t\t\t\t\tvoid this.hideLoader();\n\n\t\t\t\t\t\tlet separatorPromise = Promise.resolve();\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tseparator.type === 'page'\n\t\t\t\t\t\t\t&& !this.items.find((item) => item.options.type === 'page')\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresult.data.fields[0].label = Loc.getMessage('LANDING_FIELDS_ITEM_PAGE_TITLE')\n\t\t\t\t\t\t\t\t.replace('#number#', 1);\n\t\t\t\t\t\t\tresult.data.fields[1].label = Loc.getMessage('LANDING_FIELDS_ITEM_PAGE_TITLE')\n\t\t\t\t\t\t\t\t.replace('#number#', 2);\n\n\t\t\t\t\t\t\tseparatorPromise = Promise.all([\n\t\t\t\t\t\t\t\tthis.prependItem(result.data.fields[0]),\n\t\t\t\t\t\t\t\tthis.insertItemAfterIndex(result.data.fields[1], 1),\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresult.data.fields.forEach((field) => {\n\t\t\t\t\t\t\t\tconst [type] = field.id.split('_');\n\t\t\t\t\t\t\t\tconst count = this.items.filter((item) => {\n\t\t\t\t\t\t\t\t\treturn item.options.id.startsWith(type);\n\t\t\t\t\t\t\t\t}).length;\n\n\t\t\t\t\t\t\t\tif (type === 'page')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tfield.label = Loc.getMessage('LANDING_FIELDS_ITEM_PAGE_TITLE')\n\t\t\t\t\t\t\t\t\t\t.replace('#number#', count + 1);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (type === 'section')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tfield.label = Loc.getMessage('LANDING_FIELDS_ITEM_SECTION_TITLE')\n\t\t\t\t\t\t\t\t\t\t.replace('#number#', count + 1);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (type === 'hr')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tfield.label = Loc.getMessage('LANDING_FIELDS_ITEM_LINE_TITLE')\n\t\t\t\t\t\t\t\t\t\t.replace('#number#', count + 1);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tseparatorPromise = this.addItem(field);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tseparatorPromise.then(() => {\n\t\t\t\t\t\t\tthis.emit('onChange', {skipPrepare: true});\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t});\n\t}\n\n\tonItemRemove(event: BaseEvent)\n\t{\n\t\tthis.items = this.items.filter((item) => {\n\t\t\treturn item !== event.getTarget();\n\t\t});\n\n\t\tthis.emit('onChange', {skipPrepare: true});\n\t}\n\n\tonItemEdit(event: BaseEvent)\n\t{\n\t\tconst {options} = event.getTarget();\n\t\tif (options.fieldController)\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t\toptions.fieldController.showSettingsPopup();\n\t\t\tsetTimeout(() => {\n\t\t\t\toptions.fieldController.settingsPopup.subscribeOnce('onClose', () => {\n\t\t\t\t\toptions.sourceOptions.booking.settings_data = options.fieldController.getSettings().data;\n\n\t\t\t\t\t// eslint-disable-next-line camelcase\n\t\t\t\t\tconst {settings_data} = options.sourceOptions.booking;\n\t\t\t\t\tObject.keys(settings_data).forEach((key) => {\n\t\t\t\t\t\tif (Type.isArray(settings_data[key].value))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsettings_data[key].value = settings_data[key].value.join('|');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthis.emit('onChange', {skipPrepare: true});\n\t\t\t\t});\n\t\t\t}, 1000);\n\t\t}\n\t}\n\n\tonFormChange(event: BaseEvent)\n\t{\n\t\tthis.emit('onChange', {skipPrepare: true});\n\n\t\tconst target = event.getTarget();\n\t\tconst value = target.getValue();\n\n\t\ttarget.setDescription(value.label);\n\t}\n\n\tonDragEnd()\n\t{\n\t\tsetTimeout(() => {\n\t\t\tthis.items = [...this.getListContainer().children].map((itemNode) => {\n\t\t\t\tconst itemNodeId = Dom.attr(itemNode, 'data-id');\n\t\t\t\treturn this.items.find((item) => {\n\t\t\t\t\treturn item.options.id === itemNodeId;\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.emit('onChange', {skipPrepare: true});\n\t\t});\n\t}\n\n\tgetLoader(): Loader\n\t{\n\t\treturn this.cache.remember('loader', () => {\n\t\t\treturn new Loader({\n\t\t\t\tsize: 50,\n\t\t\t\tmode: 'inline',\n\t\t\t\toffset: {\n\t\t\t\t\ttop: '5px',\n\t\t\t\t\tleft: '225px',\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tshowLoader(): Promise<any>\n\t{\n\t\tconst loader = this.getLoader();\n\t\tconst container = this.getListContainer();\n\t\tDom.append(loader.layout, container);\n\t\treturn loader.show(container);\n\t}\n\n\thideLoader(): Promise<any>\n\t{\n\t\tconst loader = this.getLoader();\n\t\tDom.remove(loader.layout);\n\t\treturn loader.hide();\n\t}\n}"],"names":["FieldsListField","options","setEventNamespace","setLayoutClass","onSelectFieldButtonClick","bind","onSelectProductsButtonClick","onSelectSeparatorButtonClick","onItemRemove","onItemEdit","onDragEnd","onFormChange","items","forEach","itemOptions","addItem","actionPanel","ActionPanel","renderTo","layout","left","id","text","Loc","getMessage","onClick","right","draggable","Draggable","context","window","parent","container","getListContainer","dragElement","type","MOVE","offset","y","subscribe","Object","values","crmFields","reduce","acc","category","FIELDS","find","currentField","name","createItem","then","item","push","Dom","append","getLayout","unshift","prepend","index","splice","insertAfter","childNodes","fieldId","Type","isStringFilled","startsWith","isPlainObject","getCrmFieldById","isFieldAvailable","crmField","crmFieldCategory","getCrmFieldCategoryById","entity_name","caption","CAPTION","root","PageObject","getRootWindow","BX","Calendar","ResourcebookingUserfield","initCrmFormFieldController","field","dict","node","Tag","render","listItemOptions","content","sourceOptions","removable","onRemove","onEdit","form","createFieldSettingsForm","isSeparator","title","getFieldItemTitle","description","label","editable","fieldController","createResourceBookingFieldController","listItem","ListItem","Promise","resolve","isFunction","event","booking","settings_data","getData","settings","data","error","String","getSeparatorTitle","isString","fields","ProductField","selector","editing","catalog","iblockId","dictionary","hasLabel","TextField","textOnly","canBeRequired","Landing","UI","Field","Checkbox","compact","value","required","canBeMultiple","multiple","hasStringDefaultValue","bigPic","length","defaultValueField","Dropdown","map","ListSettingsField","selectedItem","currentItem","checked","isArrayFilled","valueTypes","valueType","FormSettingsForm","serializeModifier","modifiedValue","Reflect","has","Text","decode","includes","selected","Runtime","clone","products","cache","remember","preventDefault","FieldsPanel","getInstance","isLeadEnabled","show","disabledFields","selectedFields","onFieldsSelect","preparingOptions","showLoader","FormClient","prepareOptions","formOptions","result","hideLoader","all","emit","skipPrepare","getValue","promises","SeparatorPanel","separator","separatorPromise","replace","prependItem","insertItemAfterIndex","split","count","filter","getTarget","showSettingsPopup","setTimeout","settingsPopup","subscribeOnce","getSettings","keys","key","isArray","join","target","setDescription","children","itemNode","itemNodeId","attr","Loader","size","mode","top","loader","getLoader","remove","hide","BaseField"],"mappings":"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"}